# =============================================================================
# AI Guardrails - Python Pre-Commit Hooks
# =============================================================================
# Pedantic Python enforcement: types required, docstrings required.
# Uses ruff.toml if present in project root.
# Order: security → static analysis → dead code → type checking
# =============================================================================

repos:
  # Bandit - Security linter (runs first per policy)
  # Note: pre-commit passes filenames by default, so no -r flag needed
  - repo: https://github.com/PyCQA/bandit
    rev: 1.8.0
    hooks:
      - id: bandit
        name: "python - bandit security scan"
        args: ["-ll", "-ii"]
        exclude: ^tests/

  # Ruff - Lint with ALL rules enabled
  # --ignore-noqa: Disable inline noqa comments (forces exceptions through config)
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.15.0
    hooks:
      - id: ruff
        name: "python - ruff lint (pedantic)"
        args: ["--no-fix", "--ignore-noqa"]
      - id: ruff-format
        name: "python - ruff format"
        args: ["--check"]

  # Vulture - Dead code detection
  - repo: https://github.com/jendrikseipp/vulture
    rev: v2.14
    hooks:
      - id: vulture
        name: "python - vulture dead code"
        args: ["--min-confidence", "80"]

  # Mypy - Static type checking (strict mode)
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.14.1
    hooks:
      - id: mypy
        name: "python - mypy type check (strict)"
        args:
          - "--strict"
          - "--warn-unreachable"
          - "--warn-redundant-casts"
          - "--warn-unused-ignores"
          - "--no-implicit-reexport"
          - "--disallow-untyped-decorators"
        additional_dependencies: []

  # Python-specific pre-commit-hooks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
      - id: check-ast
        name: "python - check ast syntax"
      - id: debug-statements
        name: "python - no debug statements"
      - id: name-tests-test
        name: "python - test files named test_*"
        args: [--pytest-test-first]
