# =============================================================================
# AI Guardrails - Rust Pre-Commit Hooks
# =============================================================================
# Pedantic Rust enforcement: clippy pedantic + nursery, docs required.
# Uses rustfmt.toml if present in project root.
# =============================================================================

repos:
  - repo: local
    hooks:
      - id: cargo-fmt
        name: "rust - cargo fmt check"
        entry: cargo fmt
        args: ["--all", "--check"]
        language: system
        types: [rust]
        pass_filenames: false

      - id: cargo-clippy
        name: "rust - clippy (pedantic)"
        entry: cargo clippy
        args:
          - "--all-targets"
          - "--all-features"
          - "--"
          - "-D"
          - "warnings"
          - "-D"
          - "clippy::pedantic"
          - "-D"
          - "clippy::nursery"
          - "-A"
          - "clippy::module_name_repetitions"
        language: system
        types: [rust]
        pass_filenames: false

      - id: cargo-doc
        name: "rust - cargo doc (error on missing docs)"
        entry: sh
        args:
          - "-c"
          - |
            RUSTDOCFLAGS="-D missing_docs -D rustdoc::broken_intra_doc_links" \
            cargo doc --no-deps --all-features
        language: system
        types: [rust]
        pass_filenames: false

      - id: cargo-audit
        name: "rust - cargo audit CVE scan"
        entry: cargo audit
        args: ["--deny", "warnings"]
        language: system
        types: [rust]
        pass_filenames: false
